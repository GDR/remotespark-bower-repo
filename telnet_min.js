var svManager={getInstance:function(){var q=window.$telnet;if(q&&q.running&&q.running())return q;return null}};function connvertServer(q){var u=new Object;u.id=q.id;u.server=q.id;u.displayName=q.displayName||q.id;var y=q.vnc;if(y)for(var ea in y)u[ea]=y[ea];return u}
svGlobal.TELNET=function(q,u,y){function ea(c,a){function e(a,c,d,e,g,l){var f=a+g;var m=c+l;var v=I;var w;var h;var k;var n;for(h=0;h<e;h++){k=v[m+h];n=v[c+h];for(w=0;w<d;w++)k[f+w]=n[a+w]}}function d(a,c,d,e,g,l){var f=a+g;var m=c+l;var w=I;var v;var h;var k;var n;for(h=e-1;h>=0;h--){k=w[m+h];n=w[c+h];for(v=0;v<d;v++)k[f+v]=n[a+v]}}function g(a,c,d,e,l,f){var m=a+l;var v=c+f;var w=I;var h;var k;var n;var p;for(h=d-1;h>=0;h--){n=m+h;p=a+h;for(k=0;k<e;k++)w[v+k][n]=w[c+k][p]}}function m(a,c,d,e,g,
l){var h=a+g;var f=c+l;var v=I;var w;var k;var n;var p;for(w=0;w<d;w++){n=h+w;p=a+w;for(k=0;k<e;k++)v[f+k][n]=v[c+k][p]}}var I=[];var l=null;var f=new hi5.graphic.Rectangle(0,0,0,0);var h="Uint8ClampedArray"in window;this.width=c;this.height=a;var k=false;var n=this;this.pause=function(a){k=a};this.release=function(){n=null;l=null;I=null};this.isPaused=function(){return k};this.setContext=function(a){if(a==l)return;if(!l&&a&&!a.createImageData(1,1).data.buffer)h=false;l=a};this.getContext=function(){return l};
this.resize=function(d,e){for(var g=0;g<e;g++)I[g]=new Uint32Array(d);n.width=c=d;n.height=a=e};n.resize(c,a);this.getBuffer=function(){return I};this.setRGB=function(a,c,d){I[c][a]=d|4278190080};this.getRGB=function(a,c){return I[c][a]};this.setRGBs=function(a,c,d,e,g,l,w){var h=l;var f=0;var v=0;var m=a+d;var k=c+e;var n=I;var p;for(var q=c;q<k;q++,h+=w){v=h;p=n[q];for(f=a;f<m;f++)p[f]=g[v++]}};this.moveArea=function(a,c,f,l,h,k){if(k>0)d(a,c,f,l,h,k);else if(k<0)e(a,c,f,l,h,k);else if(h>0)g(a,
c,f,l,h,k);else m(a,c,f,l,h,k)};this.getRGBs=function(a,c,d,e){var f=d*e;var h=_Uint32Array(f);h[0]=0;var l=I;var g=a+d;var w=c+e;var k=0;var v;for(var m=c;m<w;m++)for(v=a;v<g;v++)h[k++]=l[m][v];return h};this.repaint=function(d,e,f,g){if(!l)return;if(d<0){f+=d;d=0}if(e<0){g+=e;e=0}if(d+f>c)f=c-d;if(e+g>a)g=a-e;var v=l.createImageData(f,g);var w=v.data;var k=d+f;var m=e+g;var n=0;var p=I;if(h){var q=new Uint32Array(w.buffer);var r;for(var t=e;t<m;t++)for(r=d;r<k;r++)q[n++]=p[t][r]}else{var u;var x;
for(t=e;t<m;t++)for(r=d;r<k;r++){u=p[t][r];x=n<<2;w[x]=u&255;w[x+1]=u>>8&255;w[x+2]=u>>16&255;w[x+3]=255;n++}}l.putImageData(v,d,e);v=null};this.postPaint=function(a,c,d,e){if(f.width>0)f.union(a,c,d,e);else{f.x=a;f.y=c;f.width=d;f.height=e}};this.commitPaint=function(){if(f.width>0){this.repaint(f.x,f.y,f.width,f.height);f.width=0}};this.fillRect=function(a,c,d,e,f){var g=I;var h=a+d;var w=c+e;var v;for(var l=c;l<w;l++)for(v=a;v<h;v++)g[l][v]=f}}function wa(c,a){if(N)N.resize(c,a);else N=new ea(c,
a);return N}function xa(){var c=q.indexOf("://");var a=q.substring(c+3);c=a.indexOf("/");if(c>0)a=a.substring(0,c);return location.protocol+"//"+a}function Ua(c){if(!sessionId)return"";return hi5.browser.httpGet(xa()+"/CLIP?s="+sessionId+"&t="+(new Date).getTime(),false)}function Va(){this.ws=null;this.setJoinMode=g.setJoinMode;this.requestControl=g.requestControl;this.writeKeyComb=g.writeKeyComb;this.getAppMode=function(){return g.mode};this.send=function(a){if(a=="891")return;if(!D)return;this.ws.send(a)};
this.sendInput=function(a){g.writeRawInput(a);if(g.onactivity)g.onactivity(a)};var c=null;this.getAppInfo=function(){return g.sessionInfo.appInfo};this.onresize=function(a){var e=a.target.svSurface;if(!e)return;var d=e.getFreeSpace();var f=d.width;var g=d.height;if(hi5.browser.isTouch||hi5.browser.isOpera)return;if(D){var h=function(){fa(f,g);ya(E,W)};if(c){clearTimeout(c);c=null}c=setTimeout(h,200)}};this.onorientationchange=function(a){};this.getClipData=Ua;this.onfocus=function(a){};this.fileCallback=
[];this.getShareFiles=function(a,c){if(loggedin){this.ws.send("3A5"+a);this.fileCallback.push(c)}};this.notifyFiles=function(a){var c=this.fileCallback;var d=0;for(var f=c.length;d<f;d++)c[d](a)};this.getFile=function(a){window.open(g.getFileUrl(a))};this.removeFile=function(a){if(uploadMgr)uploadMgr.fileService.remove(a)};this.getFileLink=function(a){return xa()+"/DOWNLOAD?s="+sessionId+"&f="+a};this.getGateway=function(){return q};this.reconnect=function(a,c,d){}}function Wa(){}function ia(c){return c==
"on"||c=="true"}function Xa(){return h.displayName||g.server}function Ya(c){if(g.setTitle)document.title=c}function za(c,a,e){this.need=c;this.handler=a;this.repeat=e||1}function Za(c){var a=0;var e=0;var d=new Uint8Array(c);var f=this;var g=new za(0,null,0);this.release=function(){g=null;d=null;f=null};this.getHandler=function(){return g};this.getData=function(){return d};this.getPosition=function(){return a};this.setPosition=function(c){a=c};this.getEnd=function(){return e};this.set=function(c,
f,g){d=c;a=f;e=g};this.handle=function(){g.handler(f,g)};this.setHandler=function(c){if(c&&c.need<1)svGlobal.logger.warn("need < 1");g=c;if(c&&e-a>=c.need)c.handler(f,c)};this.getByte=function(){return d[a++]};this.peekByte=function(){return d[a]};this.getBE32=function(){return d[a++]<<24|d[a++]<<16|d[a++]<<8|d[a++]};this.getBE16=function(){return d[a++]<<8|d[a++]};this.skip=function(c){a+=c};this.skipBack=function(c){a-=c};this.getBytes=function(c,e){if(!e){var f=a;a+=c;return d.subarray(f,a)}else for(var g=
0;g<c;g++)e[g]=d[a++]};this.copyToByteArray=function(a,c,e,g){hi5.Arrays.arraycopy(d,e,a,c,g)}}function $a(){if(D)return;Aa();if(ja)n=ja;else{var c=hi5.tool.replaceQuery(q,"pwd","x");var a=hi5.browser.binaryWS();if(a)c+="&binary=on";var e=window.opener;if(e){var d=null;try{d=e.__sparkUser}catch(g){}if(d){var f=d.account;var l=d.session;if(f)c+="&account="+f;if(l)c+="&session="+l}}var k=hi5.browser.isChrome&&hi5.browser.isDesktop;c+="&pasteCap="+(k?3:0);n=new WebSocket(c,"telnet");n.binaryType="arraybuffer"}ka.ws=
n;svGlobal.logger.info(q);n.onopen=ab;if(h["recording"]!=undefined&&h["recording"]=="on")bb(h);n.onmessage=function(a){var c=a.data;if(typeof c!="string"){var d=new Uint8Array(c);if(O!=null)O.add(new RecordingObj(d,0,c.byteLength));Z.set(d,0,c.byteLength);Z.handle()}else{var e=parseInt(c.substring(0,2),16);var g=c.substring(2);switch(e){case 26:cb(g);break;case 27:db(g);break;case 56:eb(g);break;case 59:fb(g);break;case 61:gb(g);break;case 62:hb(g);break;default:svGlobal.logger.warn("@TODO:"+c+"\n")}}};
n.onclose=ga;n.onerror=ib;fa(u+x,y+x)}function bb(c){O=new RecordingManager;var a=c.server;var e={name:a,width:c.width,height:c.height,color:c.fontSize,namesuffix:".telnetv",filetag:"TELV",duration:0};O.setHeader(e)}function db(c){if(G.drawLicense!=false){A.drawLicense(c);la(h.fontSize)}}function fb(c){}function gb(c){var a=JSON.parse(c);switch(a.type){case 0:h.fontSize=parseInt(a.fontSize);u=a.width;y=a.height;Aa();A.setAutoScale(true);fa(u+x,y+x);var e=a.server;if(e){g.server=a.server;Ya(Xa())}Ba=
a.length;if(g.onopened)g.onopened(a);break;case 1:var d=a.duration;if(g.onprogress)g.onprogress(d,Ba);break;case 2:if(a.status==2){Wa();D=true}else{var f=a.status==0;N.pause(f);if(a.warn)g.showMessage(f?__svi18n.info.sessionPaused:__svi18n.info.sessionResumed)}}}function hb(c){var a=parseInt(c.substring(0,1),16);var e;var d;var f=c.substring(1);var h=false;var k=g.sessionInfo.appInfo;switch(a){case 1:d=JSON.parse(f);if(g.onsessionjoin)h=g.onsessionjoin(d);if(h)break;g.showMessage(__svi18n.info.joinsession.applyArgs([d.numericId,
d.__ip,d.name]));break;case 2:d=JSON.parse(f);if(g.onsessionexit)h=g.onsessionexit(d);if(h)break;g.showMessage(__svi18n.info.exitsession.applyArgs([d.numericId,d.__ip,d.name]));break;case 3:d=JSON.parse(f);if(k.joinMode!=d.mode){k.joinMode=d.mode;var m=hi5.$("joinSelect");if(m)m.value=d.mode}if(k.hasControl)return;A.setReadOnly(false);e=hi5.$("requestControl");if(e)e.disabled=true;if(g.ongivecontrol)h=g.ongivecontrol();if(h)break;g.showMessage(__svi18n.info.givecontrol);break;case 4:A.setReadOnly(true);
k.hasControl=false;e=hi5.$("requestControl");if(e)e.disabled=false;if(g.ontakebackcontrol)h=g.ontakebackcontrol();if(h)break;g.showMessage(__svi18n.info.nocontrol);break;case 5:var n=function(){g.refuseControl(d.numericId);this.destroy()};var p=function(){g.giveControl(d.numericId);this.destroy()};d=JSON.parse(f);if(g.onrequirecontrol)h=g.onrequirecontrol(d);if(h)break;var q=__svi18n.info.title.applyArgs([d.name,d.numericId,d.__ip]);hi5.notifications.notify({"title":q,"msg":__svi18n.info.recontrol,
"cbYes":p,"cbNo":n});break;case 6:A.setTouchRemoting(true);break;case 7:d=JSON.parse(f);if(d.cols&&d.rows){var t=r*d.cols+x*2;var u=l*d.rows+x*2;N=wa(t,u);fa(t,u)}break;case 8:d=JSON.parse(f);if(g.onrequestcredential&&g.onrequestcredential(d))return;A.requestCredential(d);break;case 9:break;case 11:var y=function(){g.allowJoin(d.numericId,false);this.destroy()};var z=function(){g.allowJoin(d.numericId,true);this.destroy()};d=JSON.parse(f);if(g.onrequirejoin)h=g.onrequirejoin(d);if(h)break;q=__svi18n.info.title.applyArgs([d.name,
d.numericId,d.__ip]);hi5.notifications.notify({"title":q,"msg":__svi18n.info.reqjoin,"cbYes":z,"cbNo":y})}}function eb(c){var a=JSON.parse(c);var e=a;sessionId=a.session;e.server=g.server;var d=hi5.$("joinSelect");if(d)d.value=e.joinMode;d=hi5.$("requestControl");if(d)d.disabled=e.hasControl;var f=G.page&&G.page.joinssh||"jointelnet.html";f=location.protocol+"//"+location.host+"/"+f+"?id="+a.numericId;var h=a.webAddress;if(h&&h.length>0){var l=h.indexOf("://");var k=h.substring(l+3);l=k.indexOf("/");
if(l>0)k=k.substring(0,l);if(k.toLowerCase()!=location.host.toLowerCase())f+="&gateway="+k}e.joinLink=f;g.sessionInfo.appInfo=e;if(a.ver&&a.ver!=svGlobal.version)svGlobal.logger.warn("Client:"+svGlobal.version+" server:"+a.ver);if(g.onsessionstart)g.onsessionstart(g.sessionInfo)}function Pb(c){var a=__svi18n.errorCode[c];if(!a)a="error "+c;if(g.onerror)g.onerror({name:c,message:a});if(g.displayMsg)hi5.notifications.notify({"msg":a});if(svGlobal.log>0)console.error(a)}function cb(c){var a=JSON.parse(c);
if(!a.name){if(svGlobal.log>0)console.erro("No error code for message:"+c);return}svGlobal.logger.info("msg="+c);if(g.onerror)g.onerror(a);var e=__svi18n.errorCode["S"+a.name]||"";e+=a.message;g.showMessage(e)}function ab(c){svGlobal.logger.info("opened...");D=true;n.send("87"+navigator.userAgent);if(g.onopen)g.onopen()}function ib(c){svGlobal.logger.warn(c)}function ga(c){svGlobal.logger.warn("closed ...");if(R)R.style.display="none";D=false;ma=false;if(g&&g.onclose)g.onclose();try{if(O!=null){O.exit();
O=null}if(A)A.close();if(T&&T.visible()){T.dismiss();T=null}}catch(a){}if(Z){Z.release();Z=null}m=null;if(n){n.onopen=null;n.onmessage=null;n.onclose=null;n.onerror=null;n=null}ka=null;A=null;g=null;if(window&&window.$telnet)window.$telnet=null;if(O!=null){O.exit();O=null}}function jb(){B=h.fgColor||H[7];C=h.bgColor||H[0]}function la(c,a){if(!a)a=L;m.font=c+"px "+a;r=m.measureText("X").width;M=parseInt(y/l);W=parseInt(y/l);E=parseInt(u/r)}function fa(c,a){var e=c-x;var d=a-x;var f=Math.floor(d/l);
var g=Math.floor(e/r);var k=null;if(D){var n=Math.min(g*r+x,E*r+x);var p=Math.min(f*l+x,W*l+x);k=m.getImageData(0,0,n,p)}u=e;y=d;A.setSize(c,a);la(h.fontSize);na();if(k)m.putImageData(k,0,0);W=f;E=g;M=Math.floor(y/l)}function kb(){k=p;f=t;if(h.fontSize<10)h.fontSize=10;if(h.fontSize<=12){l=h.fontSize+6;ca=2}else if(h.fontSize>=13&&h.fontSize<18){l=h.fontSize+8;ca=2}else if(h.fontSize>=19&&h.fontSize<25){l=h.fontSize+12;ca=3}else if(h.fontSize>=25){l=h.fontSize+16;ca=4}la(h.fontSize);remotectrl.style.cursor=
"text"}function Aa(){if(!R){na();kb();R=document.getElementById("cursorID");R.style.display="block";R.style.width=r+"px";R.style.height=l+"px";ma=true}}function na(){m.fillStyle=C;m.fillRect(0,0,m.canvas.width,m.canvas.height);m.fillStyle=B}function Ca(c){var a="";if(lb(c))if(oa){a=F[c]||"";if(a!="")J=J+a;else J=J+String.fromCharCode(c)}else if(c>127&&c<256)J=J+F[c];else J=J+String.fromCharCode(c);else{if(J!="")Da(J);mb(c)}}function nb(c){var a=c.getByte();switch(a){case 255:Ca(a);break;case 254:case 253:case 252:case 251:var e=
c.getByte();ob(a,e);break;case 250:e=c.getByte();pb(e,c);break;default:return}if(!Ea){Ea=true;qb()}}function qb(){n.send("D0")}function pb(c,a){switch(c){case 24:var e=a.getByte();pa(a);if(e!=1)break;rb();break;case 32:e=a.getByte();pa(a);if(e!=1)break;sb();break;default:pa(a)}}function pa(c){for(;!tb;){var a=c.getByte();if(a==255){a=c.getByte();if(a==240)break}}}function ob(c,a){if(c==253&&!qa(a))aa(252,a,true);else if(c==251&&!ra(a))aa(254,a,true);else if(c==254)aa(252,a,false);else if(c==252)aa(254,
a,false);else if(c==253){aa(251,a,false);if(a==31)ya(E,W);else if(a==12)ub()}else if(c==251)aa(253,a,false)}function aa(c,a,e){n.send("D5"+c+"\t"+a+"\t"+(e==true?1:0));if(c==251){if(qa(a))Fa[a-0]=true}else if(c==252){if(qa(a))Fa[a-0]=false}else if(c==253){if(ra(a))Ga[a-0]=true}else if(c==254)if(ra(a))Ga[a-0]=false}function ub(){n.send("D7")}function ya(c,a){n.send("D9"+c+"\t"+a)}function rb(){n.send("DA")}function sb(){n.send("DC")}function qa(c){return Ha(c)&&vb[c-0]}function ra(c){return Ha(c)&&
wb[c-0]}function Qb(c){return cmd<=255&&cmd>=236}function Ha(c){return c<=39&&c>=0}function lb(c){return K==ha&&!sa[c]}function P(){K=ha}function mb(c){switch(c){case 0:case 24:P();return false;case 26:P();return false;case 5:return false;case 7:return false;case 8:xb();return false;case 9:yb();return false;case 13:zb();return false;case 10:case 11:case 12:Ab();return false;case 15:return false;case 14:return false;case 17:case 19:return false;case 27:S="";K=ta;return false;default:if(c>=128&&c<=
159)return false}switch(K){case ha:return true;case ta:if(c=="\\")return false;else if(c>=32&&c<=47){S=S+String.fromCharCode(c);return false}else if(c>=32&&c<=126||c>=160){Bb(c);if(K==ta)P();return false}return true;case Ia:if(c>=48&&c<=63){Q=Q+String.fromCharCode(c);return false}else if(c>=32&&c<=47){Q=Q+String.fromCharCode(c);return false}else if(c>=32&&c<=126||c>=160){Cb(c);P();return false}return true;case Ja:case Ka:case La:case Db:if(c>=48&&c<=63)return false;else if(c>=32&&c<=47)return false;
else if(c>=32&&c<=126||c>=160){K=Ma;return false}return true;case Ma:if(c>=32&&c<=126||c>=160)return false;return true;case Na:K=Oa;return false;case Oa:P();return false;default:K=ha;return false}}function Eb(c,a){U=c;M=a}function Bb(c){if(S==null)S="";switch(c){case 48:if(S=="(")oa=true;break;case 65:f=f-l;z();return;case 66:if(S=="(")oa=false;return;case "C":k+=r;z();return;case 68:if(S=="")Pa(1);z();return;case "E":return;case 72:k=p;f=f+l;return;case "I":return;case "J":return;case "K":case "L":return;
case 77:if(S=="")Qa(1);return;case "N":return;case "O":return;case "P":P();K=Ja;return;case "V":return;case "W":return;case "X":return;case "Y":K=Na;return;case "Z":return;case "<":return;case " ":return;case "c":P();return;case 91:Q="";P();K=Ia;return;case 93:P();K=Ka;return;case "^":P();K=La;case "_":case "\\":case ">":case "=":case "8":case "7":case "(":}}function Cb(c){var a=null;if(Q==null)Q="";if(Q!="")a=Q.split(";");var e=0;var d=0;switch(c){case 65:if(a!=null&&a.length>=1)e=parseInt(a[0]);
else e=1;f=f-e*l;if(f<t)f=t;z();return;case 66:if(a!=null&&a.length>=1)e=parseInt(a[0]);else e=1;var g=f;f+=e*l;var h=(f-g)/l;h=h==0?1:h;X("\n",h);z();return;case 67:if(a!=null&&a.length>=1)d=parseInt(a[0]);else d=1;k=k+d*r;z();return;case 68:if(a!=null&&a.length>=1)d=parseInt(a[0]);else d=1;k=k-d*r;if(k<p)k=p;z();return;case 69:if(a!=null&&a.length>=1)e=parseInt(a[0]);else e=1;g=f;f+=e*l;h=(f-g)/l;h=h==0?1:h;X("\n",h);k=p;z();return;case 70:if(a!=null&&a.length>=1)e=parseInt(a[0]);else e=1;f=f-e*
l;if(f<t)f=t;k=p;z();return;case 72:case 102:if(a!=null){if(a.length>=1){e=parseInt(a[0]);e=e-1;g=f;f=t+e*l;h=(f-g)/l;h=h==0?1:h;X("\n",h)}if(a.length>=2){d=parseInt(a[1])-1;k=p+d*r}return}else if(Q==""){k=p;f=t}return;case 73:if(a.length>=1)var n=parseInt(a[0]);else n=1;k=p+n*8*r;return;case 74:if(a!=null&&a.length>=1){var q=parseInt(a[0]);if(q==1)Fb();else if(q==2){na();k=p;f=t}}else Gb();return;case 75:if(a!=null&&a.length>=1){q=parseInt(a[0]);if(q==1)ua(p,k);else if(q==2)ua(p,u+x);z()}else ua(k,
u+x);return;case 76:if(a!=null&&a.length>=1){e=parseInt(a[0]);Qa(e);z()}break;case 77:if(a!=null&&a.length>=1){e=parseInt(a[0]);Pa(e);z()}break;case "S":break;case "T":break;case 80:if(a!=null&&a.length>=1)d=parseInt(a[0]);else d=1;var y=m.getImageData(k+d*r,f,u+x-k-d*r,l);m.fillStyle=C;m.fillRect(k,f,u+x-k,l);m.putImageData(y,k,f);m.fillStyle=B;z();break;case 88:if(a!=null&&a.length>=1)d=parseInt(a[0]);else d=1;m.fillStyle=C;m.fillRect(k,f,d*r,l);m.fillStyle=B;break;case "c":break;case "g":break;
case "i":break;case 109:Hb(a);break;case "n":break;case "q":break;case 114:if(a!=null&&a.length>=2)Eb(parseInt(a[0]),parseInt(a[1]));case "x":case "y":default:}}function Fb(){m.fillStyle=C;m.fillRect(p,t,E*r,f-chart_height-t);m.fillRect(p,f,f-p,chart_height);m.fillStyle=B}function ua(c,a){m.fillStyle=C;m.fillRect(c,f,a-c,l);m.fillStyle=B}function Hb(c){if(c==null||c.length==0){m.font="normal "+h.fontSize+"px "+L;jb()}else{var a=c.length;var e=0;for(var d=0;d<a;d++){e=c[d]*1;switch(e){case 0:m.font=
"normal "+h.fontSize+"px "+L;C=H[0];B=H[7];break;case 1:m.font="bold "+h.fontSize+"px "+L;break;case 4:break;case 5:m.font="italic "+h.fontSize+"px "+L;break;case 7:m.font="normal "+h.fontSize+"px "+L;C=H[7];B=H[0];break;case 22:m.font="normal "+h.fontSize+"px "+L;C=H[0];B=H[7];break;case 24:break;case 25:m.font="italic "+h.fontSize+"px "+L;break;case 27:m.font="normal "+h.fontSize+"px "+L;C=H[7];B=H[0];break;default:if(c[d]>=30&&c[d]<=39)B=H[c[d]-30+1];else if(c[d]>=40&&c[d]<=49)C=H[c[d]-40+1]}}}}
function Gb(){m.fillStyle=C;m.fillRect(k,f,E*r-k+p,W*l-f+t);m.fillStyle=B}function xb(){k=k-r;if(k<p)k=p;z()}function yb(){var c=(k-p)/r/Ra;c=c*1;c=parseInt(c)+1;k=c*Ra*r+p;if(k>=E*r){k=p;f+=l;X("\n")}z()}function Qa(c){var a=m.getImageData(p,t+(U-1)*l,E*r,(M-U-c+1)*l);m.fillStyle=C;m.fillRect(p,t+(U-1)*l,E*r,l*c);m.putImageData(a,p,t+(U+c-1)*l);m.fillStyle=B}function Pa(c){var a=m.getImageData(p,(U+c-1)*l+t,E*r,(M-U-c+1)*l);m.fillStyle=C;m.fillRect(p,(M-c)*l+t,E*r,c*l);m.putImageData(a,p,(U-1)*l+
t);m.fillStyle=B}function zb(){k=p;if(f>t+(M-1)*l)f=t+(M-1)*l;z()}function Ab(){f+=l;X("\n");z();Ib()}function Ib(){if(k>=E*r){k=p;f+=l;X("\n")}if(f>(M-1)*l+t){for(;f>(M-1)*l+t;)f-=l;z();var c=m.getImageData(p,t+l,E*r,(M-1)*l);m.fillStyle=C;m.fillRect(p,t,E*r,M*l);m.putImageData(c,p,t);m.fillStyle=B}}function Da(c){var a=c;var e=a.length;if(f+l>y)f=(W-1)*l+t;m.fillStyle=C;m.fillRect(k,f,r*e,l);m.fillStyle=B;m.fillText(a,k,f+l-3*ca);k=k+m.measureText(a).width;X(a);z();J=""}function Rb(c,a,e){var d=
(a-t)/l;if(c==p)Jb[d]=e}function z(){R.style.top=f+"px";R.style.left=k+"px"}function Sb(c){if(!g.openLink)return false;var a=c;c=c.toLowerCase();var e=c.indexOf("http://")==0||c.indexOf("https://")==0||c.indexOf("ftp://")==0||c.indexOf("mailto:")==0||c.indexOf("tel:")==0||c.indexOf("callto:")==0;if(!e)if(c.indexOf("www.")==0){e=true;c="http://"+c}else if(c.indexOf("ftp.")==0){e=true;c="ftp://"+c}if(e){if(c.indexOf("\r")>0||c.indexOf("\n")>0)return false;if(g.onurlredirection&&g.onurlredirection(e))return true;
A.processLink(a);return true}return false}function Kb(c){if(!D)return;var a=c.getData("text/plain");if(a){a=a.replace(/\r\n/g,"\n");Y(0,a,3);return true}return false}function Lb(){if(!T)return;if(!ba)return;if(T.visible())return;ba.value=da;T.show();if(A)A.setIgnorePaste(false);setTimeout(function(){ba.scrollTop=ba.scrollHeight;ba.disabled=false},10)}function X(c,a){if(T)if(a)for(var e=0;e<a;e++)da=da+c;else da=da+c}function Y(c,a,e){n.send("8B"+e+"\t"+a)}if(sessionStorage)sessionStorage.clear();
var ba=document.getElementById("copytextarea");var T=ba?new hi5.Lightbox(document.getElementById("copydialog")):null;var da="";this.displayMsg=true;this.reconnectTimes=0;this.openLink=true;this.setTitle=true;this.mode=0;var ja=typeof q=="object"?q:null;var Sa=typeof q=="object"||q.indexOf("/PLAY?")>0;if(Sa){this.mode=1;if(ja)q="";q+="&touchpad=on"}else if(q.indexOf("/JOIN?")>0){this.mode=2;this.reconnectOnResize=false}var G=hi5.appcfg||{img:{},toolbar:{fadable:true}};this.sessionInfo={major:0,minor:0,
width:0,height:0,bpp:0,bigEndian:true,trueColor:true};var A=null;var D=false;var ma=false;var x=5;var O=null;window.$telnet=this;G.copyDialog=true;var ha=0;var ta=27;var Ia=155;var Ja=144;var Ka=157;var La=158;var Db=159;var Ma=160;var Na=161;var Oa=162;var F=new Array;for(var V=0;V<127;V++)F[V]=String.fromCharCode(V);F[106]="+";F[107]="+";F[108]="+";F[109]="+";F[110]="+";F[113]="_";F[116]="+";F[117]="+";F[118]="+";F[119]="+";F[120]="|";(function a(){var e={128:199,129:252,130:233,131:226,132:228,
133:224,134:229,135:231,136:234,137:235,138:232,139:239,140:238,141:236,142:196,143:197,144:201,145:230,146:198,147:244,148:246,149:242,150:251,151:249,152:255,153:214,154:220,155:162,156:163,157:165,158:8359,159:402,160:225,161:237,162:243,163:250,164:241,165:209,166:170,167:186,168:191,169:8976,170:172,171:189,172:188,173:161,174:171,175:187,176:9617,177:9618,178:9619,179:9474,180:9508,181:9569,182:9570,183:9558,184:9557,185:9571,186:9553,187:9559,188:9565,189:9564,190:9563,191:9488,192:9492,193:9524,
194:9516,195:9500,196:9472,197:9532,198:9566,199:9567,200:9562,201:9556,202:9577,203:9574,204:9568,205:9552,206:9580,207:9575,208:9576,209:9572,210:9573,211:9561,212:9560,213:9554,214:9555,215:9579,216:9578,217:9496,218:9484,219:9608,220:9604,221:9612,222:9616,223:9600,224:945,225:223,226:915,227:960,228:931,229:963,230:181,231:964,232:934,233:920,234:937,235:948,236:8734,237:966,238:949,239:8745,240:8801,241:177,242:8805,243:8804,244:8992,245:8993,246:247,247:8776,248:176,249:8729,250:183,251:8730,
252:8319,253:178,254:9632,255:160};for(var d=128;d<256;d++)F[d]=String.fromCharCode(e[d])})();var wb=[true,true,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false];var vb=[true,false,false,true,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,true,false,
false,false,false,false,false,true,true,false,false,false,false,false,false,false,false];var Fa=[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false];var Ga=[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,
false,false,false,false,false,false,false,false,false,false,false,false,false,false];var sa=new Array(256);var Ta=[0,5,7,8,9,10,11,12,13,14,15,17,19,24,26,27,127,132,133,136,141,142,143,144,155,156,157,158,159];for(V=0;V<256;V++)sa[V]=false;for(var va=0;va<Ta.length;va++)sa[Ta[va]]=true;var Z=new Za(4194304);this.running=function(){return D};var g=this;var n=null;var h=hi5.tool.queryToObj(q.substring(q.indexOf("?")+1));if(!u)u=window.innerWidth;u-=x;h.width=u;q+="&width="+u;if(!y)y=window.innerHeight;
y-=x;h.height=y;q+="&height="+y;if(!h.fontSize){h.fontSize=13;q+="&fontSize="+13}else h.fontSize=parseInt(h.fontSize,10);this.server=h["server"];this.port=h["port"]?parseInt(h["port"],10):23;var H=["black","red","green","yellow","blue","magenta","cyan","white","gray","violet"];var N=wa(u,y);var m=N.getContext();var ka=new Va;if(G.displayMsg!=undefined)this.displayMsg=G.displayMsg;if(G.reconnectTimes!=undefined)this.reconnectTimes=G.reconnectTimes;if(G.openLink!=undefined)this.openLink=G.openLink;
if(G.setTitle!=undefined)this.setTitle=G.setTitle;if(typeof G.useWSS=="boolean")q=(G.useWSS?"wss":"ws")+q.substring(q.indexOf("://"));this.getURL=function(){return q};this.setJoinMode=function(a){if(!D)return;n.send("8E1"+a)};this.refuseControl=function(a){if(!D)return;n.send("8E3"+a)};this.giveControl=function(a){if(!D)return;n.send("8E4"+a)};this.requestControl=function(){if(!D)return;n.send("8E2")};this.play=function(){n.send("F3")};this.pause=function(){n.send("F2")};this.scan=function(a){n.send("F4"+
(a?"1":"0"))};this.seek=function(a){if(A&&D){n.send("F4"+(a?"1":"0")+"\t"+(a/A.getScale()|0));N.pause(true)}};var Ba=0;this.run=function(){$a()};this.hide=function(){if(!A)return;if(document.getElementById("cursorID").style.display=="block")document.getElementById("cursorID").style.display="none";A.hide()};this.showMessage=function(a){if(!g.displayMsg||!a)return;hi5.notifications.notify({"msg":a})};this.close=function(){if(n&&D)try{n.send("85");n.close()}catch(a){}else ga()};if(!hi5.browser.isChromeApp)window.addEventListener("unload",
ga,false);else chrome.runtime.onSuspend.addListener(ga);var Ea=false;var tb=false;var R=null;x=5;var p=x;var t=5;var k=0;var f=0;var L=h.fontName||"Courier New";if(L.indexOf(" ")>0)L='"'+L+'"';var B=h.fgColor||H[7];var C=h.bgColor||H[0];var K=0;var Ra=8;var Q="";var S="";var r=0;var l=18;var ca=0;var J="";var oa=false;var W=0;var E=0;var U=1;var M=24;var Mb=new za(1024,function e(d){for(var f=true;f;){b=d.getByte();if(b<0)break;if(b==255)nb(d);else Ca(b);if(d.getPosition()>=d.getEnd()){if(J!="")Da(J);
f=false}}});Z.setHandler(Mb);var Jb=new Array;this.addSurface=function(e){A=e;if(Sa)e.setPlayerMode();N.setContext(A.context);m=N.getContext();e.forceTextArea=true;e.setAutoScale(g.mode>0);e.setSize(u+x,y+x);e.setController(ka);e.setFastCopy(ia(h["fastCopy"]));e.setTouchpad(ia(h["touchpad"]));e.setClipboard(ia(h["mapClipboard"]));e.run(99997);e.onclipdata=Kb};var Nb=new Uint8Array(6);Nb[0]=5;var Ob=new Uint8Array(8);Ob[0]=4;this.writeRawInput=function(e){if(!ma)return;var d=parseInt(e.substring(0,
2),16);var f=e.substring(2).split("\t");var g=0;var h=false;switch(d){case 128:var k=f[2];if(k==2)Lb();return;case 129:return;case 130:return;case 131:return;case 132:if(f[0]==0){g=parseInt(f[1]);h=f[0]==0;Y(h,g,0)}else if(f[1]==42)Y(0,42,2);else if(f[1]==29)Y(0,29,2);return;case 139:if(f[0]==0){g=parseInt(f[1]);h=f[0]==0;Y(h,g,1)}return;case 134:g=f[0].charCodeAt(0);if(g==47)Y(true,191,1);else Y(0,f[0],3);return}svGlobal.logger.warn("Unknowncode: "+f[1]+" type:"+d)}};
