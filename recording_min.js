RecordingManager=function(){function m(){d=0;if(h.length>0)h.length=0;if(f.length>0)f.length=0}function q(b){if(d>0&&f.length>0){var a="Please download the recorded file first";t.exit();(b||window.event).returnValue=a;return a}}function p(b){var n=0;var c=new Uint8Array(64);k(c,b["filetag"]||u,4,0);a(c,v,2,4);a(c,b.width,2,6);a(c,b.height,2,8);a(c,b.color,1,10);a(c,d,8,11);a(c,b.duration,8,19);a(c,w,4,27);h.push(c)}function a(b,a,c,d){for(var e=c-1;e>=0;e--)b[d++]=a>>e*8&255}function k(b,a,c,d){for(var e=
0;e<c;e++)b[d++]=a.charCodeAt(e)}function x(b){var n=b.getType();var c=new Uint8Array(n==-1?8:10);a(c,b.getLen()+(n==-1?0:2),4,0);a(c,b.getTime()-d,4,4);if(n!=-1){a(c,b.getType()&255,1,8);a(c,b.getType()>>8,1,9)}h.push(c);h.push(b.getData())}var f=[];var A=true;var y=".rdpv";var l="";var u="RDPV";var d=0;var v=0;var z="name";var B="width";var C="height";var D="color";var E="host";var g;var r="";var F=false;var G=0;var H=0;var I=0;var w=1;var h=[];var t=this;this.setHeader=function(b){m();d=(new Date).getTime();
g=b;l=y;if(g["namesuffix"]!=null&&g["namesuffix"]!=undefined)l=g["namesuffix"];r=g[z]+d+l;window.addEventListener("beforeunload",q,false)};this.add=function(b){if(d>0)f.push(b)};this.exit=function(){var b=f.length;if(b==0||d==0)return;g.duration=f[b-1].getTime()-d;p(g);for(var a=0;a<b;a++)x(f[a]);var c=new Blob(h,{type:"application/octet-binary"});m();var k=URL.createObjectURL(c);var e="";if(__svi18n&&__svi18n.info)e=__svi18n.info.recready;if(!e)e="Recorded file is ready. Please right click and save the link.";
var l='<a href="'+k+'" target="_blank" download="'+r+'">'+e+"</a>";hi5.notifications.notify({msg:l,cbClose:function(){setTimeout(function(){(window.URL||window.webkitURL).revokeObjectURL(k)},999)}})}};RecordingObj=function(m,q,p,a){var k=(new Date).getTime();if(typeof a=="undefined")a=48;this.strToInt=function(a){return parseInt(a,16)};this.getLen=function(){return p};this.getTime=function(){return k};this.getType=function(){return a};this.getData=function(){return m}};
