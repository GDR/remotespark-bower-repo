var svManager={getInstance:function(){var e=window.$ssh;if(e&&e.running&&e.running())return e;return null}};function connvertServer(e){var q=new Object;q.id=e.id;q.server=e.id;q.displayName=e.displayName||e.id;var r=e.ssh;if(r){for(var Q in r)q[Q]=r[Q];q.user=r.username||"";q.pwd=r.password||""}return q}
svGlobal.SSH=function(e,q,r,Q){function ya(b,c){function d(a,b,c,d,f,e){var h=a+f;var v=b+e;var l=y;var w;var k;var g;var m;for(k=0;k<d;k++){g=l[v+k];m=l[b+k];for(w=0;w<c;w++)g[h+w]=m[a+w]}}function a(a,b,c,d,f,e){var l=a+f;var h=b+e;var v=y;var w;var k;var g;var m;for(k=d-1;k>=0;k--){g=v[h+k];m=v[b+k];for(w=0;w<c;w++)g[l+w]=m[a+w]}}function f(a,b,c,d,e,w){var v=a+e;var l=b+w;var h=y;var k;var g;var m;var n;for(k=c-1;k>=0;k--){m=v+k;n=a+k;for(g=0;g<d;g++)h[l+g][m]=h[b+g][n]}}function l(a,b,c,d,f,
e){var w=a+f;var h=b+e;var v=y;var k;var g;var m;var n;for(k=0;k<c;k++){m=w+k;n=a+k;for(g=0;g<d;g++)v[h+g][m]=v[b+g][n]}}var y=[];var h=null;var e=new hi5.graphic.Rectangle(0,0,0,0);var k="Uint8ClampedArray"in window;this.width=b;this.height=c;var m=false;var g=this;this.pause=function(a){m=a};this.release=function(){g=null;h=null;y=null};this.isPaused=function(){return m};this.setContext=function(a){if(a==h)return;if(!h&&a&&!a.createImageData(1,1).data.buffer)k=false;h=a};this.getContext=function(){return h};
this.resize=function(a,d){for(var f=0;f<d;f++)y[f]=new Uint32Array(a);g.width=b=a;g.height=c=d};g.resize(b,c);this.getBuffer=function(){return y};this.setRGB=function(a,b,c){y[b][a]=c|4278190080};this.getRGB=function(a,b){return y[b][a]};this.setRGBs=function(a,b,c,d,f,k,e){var w=k;var v=0;var h=0;var l=a+c;var g=b+d;var m=y;var n;for(var p=b;p<g;p++,w+=e){h=w;n=m[p];for(v=a;v<l;v++)n[v]=f[h++]}};this.moveArea=function(b,c,k,e,h,g){if(g>0)a(b,c,k,e,h,g);else if(g<0)d(b,c,k,e,h,g);else if(h>0)f(b,
c,k,e,h,g);else l(b,c,k,e,h,g)};this.getRGBs=function(a,b,c,d){var f=c*d;var h=_Uint32Array(f);h[0]=0;var k=y;var e=a+c;var v=b+d;var w=0;var g;for(var l=b;l<v;l++)for(g=a;g<e;g++)h[w++]=k[l][g];return h};this.repaint=function(a,d,f,e){if(!h)return;if(a<0){f+=a;a=0}if(d<0){e+=d;d=0}if(a+f>b)f=b-a;if(d+e>c)e=c-d;var g=h.createImageData(f,e);var v=g.data;var w=a+f;var l=d+e;var m=0;var n=y;if(k){var p=new Uint32Array(v.buffer);var q;for(var r=d;r<l;r++)for(q=a;q<w;q++)p[m++]=n[r][q]}else{var t;var u;
for(r=d;r<l;r++)for(q=a;q<w;q++){t=n[r][q];u=m<<2;v[u]=t&255;v[u+1]=t>>8&255;v[u+2]=t>>16&255;v[u+3]=255;m++}}h.putImageData(g,a,d);g=null};this.postPaint=function(a,b,c,d){if(e.width>0)e.union(a,b,c,d);else{e.x=a;e.y=b;e.width=c;e.height=d}};this.commitPaint=function(){if(e.width>0){this.repaint(e.x,e.y,e.width,e.height);e.width=0}};this.fillRect=function(a,b,c,d,f){var e=y;var v=a+c;var h=b+d;var g;for(var k=b;k<h;k++)for(g=a;g<v;g++)e[k][g]=f}}function oa(b,c){if(F)F.resize(b,c);else F=new ya(b,
c);return F}function pa(){var b=e.indexOf("://");var c=e.substring(b+3);b=c.indexOf("/");if(b>0)c=c.substring(0,b);return location.protocol+"//"+c}function za(b){if(!sessionId)return"";return hi5.browser.httpGet(pa()+"/CLIP?s="+sessionId+"&t="+(new Date).getTime(),false)}function da(b,c){var d=b-A;var a=c-A;var e=Math.floor(a/l);var g=Math.floor(d/n);var y=null;if(B){var m=Math.min(g*n+A,C*n+A);var p=Math.min(e*l+A,V*l+A);y=h.getImageData(0,0,m,p)}q=d;r=a;u.setSize(b,c);h.font=k.fontSize+"px Courier New";
qa();if(y)h.putImageData(y,0,0);V=e;C=g;H=Math.floor(r/l);if(f.onresolutionchange)f.onresolutionchange(q,r)}function Aa(){this.ws=null;this.setJoinMode=f.setJoinMode;this.requestControl=f.requestControl;this.writeKeyComb=f.writeKeyComb;this.getAppMode=function(){return f.mode};this.send=function(b){if(b=="891")return;if(!B)return;this.ws.send(b)};this.sendInput=function(b){f.writeRawInput(b);if(f.onactivity)f.onactivity(b)};var b=null;this.getAppInfo=function(){return f.sessionInfo.appInfo};this.onresize=
function(c){var d=c.target.svSurface;if(!d)return;var a=d.getFreeSpace();var f=a.width;var e=a.height;if(hi5.browser.isTouch||hi5.browser.isOpera)return;if(B){var g=function(){da(f,e);Ba(q,r)};if(b){clearTimeout(b);b=null}b=setTimeout(g,200)}};this.onorientationchange=function(b){};this.getClipData=za;this.onfocus=function(b){};this.fileCallback=[];this.getShareFiles=function(b,d){if(loggedin){this.ws.send("3A5"+b);this.fileCallback.push(d)}};this.notifyFiles=function(b){var d=this.fileCallback;var a=
0;for(var f=d.length;a<f;a++)d[a](b)};this.getFile=function(b){window.open(f.getFileUrl(b))};this.removeFile=function(b){if(uploadMgr)uploadMgr.fileService.remove(b)};this.getFileLink=function(b){return pa()+"/DOWNLOAD?s="+sessionId+"&f="+b};this.getGateway=function(){return e};this.reconnect=function(b,d,a){}}function ea(b){return b=="on"||b=="true"}function Ca(){return k.displayName||f.server}function Da(b){if(f.setTitle)document.title=b}function ra(b,c,d){this.need=b;this.handler=c;this.repeat=
d||1}function Ea(b){var c=0;var d=0;var a=new Uint8Array(b);var f=this;var e=new ra(0,null,0);this.release=function(){e=null;a=null;f=null};this.getHandler=function(){return e};this.getData=function(){return a};this.getPosition=function(){return c};this.setPosition=function(a){c=a};this.getEnd=function(){return d};this.set=function(b,f,e){a=b;c=f;d=e};this.handle=function(){e.handler(f,e)};this.setHandler=function(a){if(a&&a.need<1)svGlobal.logger.warn("need < 1");e=a;if(a&&d-c>=a.need)a.handler(f,
a)};this.getByte=function(){return a[c++]};this.peekByte=function(){return a[c]};this.getBE32=function(){return a[c++]<<24|a[c++]<<16|a[c++]<<8|a[c++]};this.getBE16=function(){return a[c++]<<8|a[c++]};this.skip=function(a){c+=a};this.skipBack=function(a){c-=a};this.getBytes=function(b,d){if(!d){var f=c;c+=b;return a.subarray(f,c)}else for(var e=0;e<b;e++)d[e]=a[c++]};this.copyToByteArray=function(b,c,d,f){hi5.Arrays.arraycopy(a,d,b,c,f)}}function Fa(){if(B)return;if(fa){m=fa;ga()}else{sa();e+="&cols="+
C+"&rows="+V;var b=e;var c=hi5.browser.binaryWS();if(c)b+="&binary=on";var d=window.opener;if(d){var a=null;try{a=d.__sparkUser}catch(g){}if(a){var h=a.account;var l=a.session;if(h)b+="&account="+h;if(l)b+="&session="+l}}var n=hi5.browser.isChrome&&hi5.browser.isDesktop;b+="&pasteCap="+(n?3:0);e=b;b=f.mode==0&&D.wsPost?e.substring(0,e.indexOf("?"))+"?_METHOD=post":e;m=new WebSocket(b,"ssh");m.binaryType="arraybuffer"}ha.ws=m;svGlobal.logger.info(e);m.onopen=Ga;if(k["recording"]!=undefined&&k["recording"]==
"on")Ha(k);m.onmessage=function(a){var b=a.data;if(typeof b!="string"){var c=new Uint8Array(b);if(I!=null)I.add(new RecordingObj(c,0,b.byteLength));R.set(c,0,b.byteLength);R.handle()}else{var d=parseInt(b.substring(0,2),16);var f=b.substring(2);switch(d){case 0:Ia();break;case 15:Ja(f);break;case 26:Ka(f);break;case 27:La(f);break;case 56:Ma(f);break;case 59:Na(f);break;case 61:Oa(f);break;case 62:Pa(f);break;case 91:Qa(f);break;case 93:Ra(f);break;default:svGlobal.logger.warn("@TODO:"+b+"\n")}}};
m.onclose=ba;m.onerror=Sa}function Ia(){var b=e.substring(e.indexOf("?")+1);m.send("00"+b);m.send("87"+navigator.userAgent)}function Ha(b){I=new RecordingManager;var c=b.user.length>0?b.server+"_"+b.user:b.server;var d={name:c,width:b.width,height:b.height,color:b.fontSize,namesuffix:".sshv",filetag:"SSHV",duration:0};I.setHeader(d)}function La(b){if(D.drawLicense!=false)u.drawLicense(b)}function Ja(b){if(f.onready)f.onready();if(f.onloggedin)f.onloggedin()}function Na(b){}function Oa(b){var c=JSON.parse(b);
switch(c.type){case 0:k.fontSize=parseInt(c.fontSize);q=c.width;r=c.height;ga();u.setAutoScale(true);da(q+A,r+A);var d=c.server;if(d){f.server=c.server;Da(Ca())}ta=c.length;if(f.onopened)f.onopened(c);break;case 1:var a=c.duration;if(f.onprogress)f.onprogress(a,ta);break;case 2:if(c.status==2){Ta();B=true}else{var e=c.status==0;F.pause(e);if(c.warn)f.showMessage(e?__svi18n.info.sessionPaused:__svi18n.info.sessionResumed)}}}function Ta(){}function Ra(b){t+=l;g=p;W(__svi18n.info.password||b);X=true}
function Qa(b){ia=true;W(__svi18n.info.user||b);L=true}function Pa(b){var c=parseInt(b.substring(0,1),16);var d;var a;var e=b.substring(1);var g=false;var h=f.sessionInfo.appInfo;switch(c){case 1:a=JSON.parse(e);if(f.onsessionjoin)g=f.onsessionjoin(a);if(g)break;f.showMessage(__svi18n.info.joinsession.applyArgs([a.numericId,a.__ip,a.name]));break;case 2:a=JSON.parse(e);if(f.onsessionexit)g=f.onsessionexit(a);if(g)break;f.showMessage(__svi18n.info.exitsession.applyArgs([a.numericId,a.__ip,a.name]));
break;case 3:a=JSON.parse(e);if(h.joinMode!=a.mode){h.joinMode=a.mode;var k=hi5.$("joinSelect");if(k)k.value=a.mode}if(h.hasControl)return;u.setReadOnly(false);d=hi5.$("requestControl");if(d)d.disabled=true;if(f.ongivecontrol)g=f.ongivecontrol();if(g)break;f.showMessage(__svi18n.info.givecontrol);break;case 4:u.setReadOnly(true);h.hasControl=false;d=hi5.$("requestControl");if(d)d.disabled=false;if(f.ontakebackcontrol)g=f.ontakebackcontrol();if(g)break;f.showMessage(__svi18n.info.nocontrol);break;
case 5:var l=function(){f.refuseControl(a.numericId);this.destroy()};var m=function(){f.giveControl(a.numericId);this.destroy()};a=JSON.parse(e);if(f.onrequirecontrol)g=f.onrequirecontrol(a);if(g)break;var n=__svi18n.info.title.applyArgs([a.name,a.numericId,a.__ip]);hi5.notifications.notify({"title":n,"msg":__svi18n.info.recontrol,"cbYes":m,"cbNo":l});break;case 6:u.setTouchRemoting(true);break;case 7:a=JSON.parse(e);if(a.width&&a.height){F=oa(a.width,a.height);da(a.width+A,a.height+A)}break;case 8:a=
JSON.parse(e);if(f.onrequestcredential&&f.onrequestcredential(a))return;u.requestCredential(a);break;case 9:break;case 11:var p=function(){f.allowJoin(a.numericId,false);this.destroy()};var q=function(){f.allowJoin(a.numericId,true);this.destroy()};a=JSON.parse(e);if(f.onrequirejoin)g=f.onrequirejoin(a);if(g)break;n=__svi18n.info.title.applyArgs([a.name,a.numericId,a.__ip]);hi5.notifications.notify({"title":n,"msg":__svi18n.info.reqjoin,"cbYes":q,"cbNo":p})}}function Ma(b){var c=JSON.parse(b);var d=
c;sessionId=c.session;d.server=f.server;var a=hi5.$("joinSelect");if(a)a.value=d.joinMode;a=hi5.$("requestControl");if(a)a.disabled=d.hasControl;var e=D.page&&D.page.joinssh||"joinssh.html";e=location.protocol+"//"+location.host+"/"+e+"?id="+c.numericId;var g=c.webAddress;if(g&&g.length>0){var h=g.indexOf("://");var k=g.substring(h+3);h=k.indexOf("/");if(h>0)k=k.substring(0,h);if(k.toLowerCase()!=location.host.toLowerCase())e+="&gateway="+k}d.joinLink=e;f.sessionInfo.appInfo=d;if(c.ver&&c.ver!=svGlobal.version)svGlobal.logger.warn("Client:"+
svGlobal.version+" server:"+c.ver);ga();if(f.onsessionstart)f.onsessionstart(f.sessionInfo)}function wb(b){var c=__svi18n.errorCode[b];if(!c)c="error "+b;if(f.onerror)f.onerror({name:b,message:c});if(f.displayMsg)hi5.notifications.notify({"msg":c});if(svGlobal.log>0)console.error(c)}function Ka(b){var c=JSON.parse(b);if(!c.name){if(svGlobal.log>0)console.erro("No error code for message:"+b);return}svGlobal.logger.info("msg="+b);if(f.onerror)f.onerror(c);var d=__svi18n.errorCode["S"+c.name]||"";d+=
c.message;f.showMessage(d)}function Ga(b){svGlobal.logger.info("opened...");B=true;m.send("87"+navigator.userAgent);if(f.onopen)f.onopen()}function Sa(b){svGlobal.logger.warn(b)}function ba(b){svGlobal.logger.warn("closed ...");N.style.display="none";B=false;ia=false;if(f&&f.onclose)f.onclose();try{if(I!=null){I.exit();I=null}if(u)u.close();if(O&&O.visible()){O.dismiss();O=null}}catch(c){}if(R){R.release();R=null}h=null;if(m){m.onopen=null;m.onmessage=null;m.onclose=null;m.onerror=null;m=null}ha=
null;u=null;if(F){F.release();F=null}if(f)f=null;if(window&&window.$ssh)window.$ssh=null;if(I!=null){I.exit();I=null}}function sa(){if(k.fontSize<10)k.fontSize=10;if(k.fontSize<=12){l=k.fontSize+6;Y=2}else if(k.fontSize>=13&&k.fontSize<18){l=k.fontSize+8;Y=2}else if(k.fontSize>=19&&k.fontSize<25){l=k.fontSize+12;Y=3}else if(k.fontSize>=25){l=k.fontSize+16;Y=4}h.font=k.fontSize+"px Courier New";n=h.measureText("X").width;H=parseInt(r/l);V=parseInt(r/l);C=parseInt(q/n)}function ga(){qa();g=p;t=z;sa();
remotectrl.style.cursor="text";if(N==null){N=document.getElementById("cursorID");N.style.display="block";N.style.width=n+"px";N.style.height=l+"px"}ia=true}function Ua(){var b=h.getImageData(p,z+(G-1)*l,C*n,(H-G)*l);h.fillStyle="black";h.fillRect(0,z+(G-1)*l,C*n,l);h.putImageData(b,p,z+G*l);h.fillStyle="white"}function Va(){var b=h.getImageData(p,G*l+z,C*n,(H-G)*l);h.fillStyle="black";h.fillRect(p,H*l-l+z,C*n,l);h.putImageData(b,p,(G-1)*l+z);h.fillStyle="white"}function Wa(){}function Xa(){var b=
(g-p)/n/ua;b=b*1;b=parseInt(b)+1;g=b*ua*n+p;if(g>=C*n){g=p;t+=l;Z("\n")}J()}function Ya(){}function Za(){t+=l;Z("\n");$a()}function $a(){if(g>=C*n){g=p;t+=l;Z("\n")}if(t>(H-1)*l+z){for(;t>(H-1)*l+z;)t-=l;J();var b=h.getImageData(p,z+(G-0)*l,C*n,(H-G)*l);h.fillStyle="black";h.fillRect(p,z+(G-1)*l,C*n,(H-G+1)*l);h.putImageData(b,p,z+(G-1)*l);h.fillStyle="white"}}function ja(){g=g-n;if(g<p)g=p;J()}function ab(b){g+=b*n;J()}function bb(b){t+=b*l;Z("\n");J()}function cb(b){g-=b*n;J()}function db(b){t-=
b*l;J()}function eb(b,c){g=(c-1)*n+p;if(g<p)g=p;t=(b-1)*l+z;J()}function fb(b,c){G=b;H=c}function S(b){va=b}function T(b){wa=b;h.fillStyle=ka[b]}function gb(){h.fillStyle="black";h.fillRect(g,t,C*n-g+p,l);h.fillStyle="white"}function hb(){h.fillStyle="black";h.fillRect(p,t,g,l);h.fillStyle="white"}function ib(){h.fillStyle="black";h.fillRect(g,t,C*n-g+p,V*l-t+z);h.fillStyle="white"}function qa(){h.fillStyle="black";h.fillRect(0,0,h.canvas.width,h.canvas.height);h.fillStyle="white"}function J(){N.style.top=
t+"px";N.style.left=g+"px"}function jb(b){W(kb(b))}function W(b){U=b.length;h.fillStyle=ka[va];h.fillRect(g,t,n*U,l);h.fillStyle=ka[wa];h.fillText(b,g,t+l-3*Y);g=g+U*n;if(g>p+(C-1)*n)g=p+(C-1)*n;Z(b);J()}function kb(b){var c="";var d=b.getPosition();var a;U=0;for(var f=new Array;d<b.getEnd();){a=b.getByte();if(32<=a&&a<=255){c=c+String.fromCharCode(a);d++;f[U++]=a;continue}if(a==13||a==27||a==8||a==9)b.skipBack(1);break}if(U>0)c=lb(f);return c}function lb(b){var c="";var d=0;for(var a=c1=c2=0;d<b.length;){a=
b[d];if(a<128){c+=String.fromCharCode(a);d++}else if(a>191&&a<224){c2=b[d+1];c+=String.fromCharCode((a&31)<<6|c2&63);d+=2}else{c2=b[d+1];c3=b[d+2];c+=String.fromCharCode((a&15)<<12|(c2&63)<<6|c3&63);d+=3;U--}}return c}function mb(b){var c=String.fromCharCode(b);P=P+c;if(L)W(c)}function xb(b,c,d){var a=(c-z)/l;if(b==p)nb[a]=d}function ob(){g=p;if(t>z+(H-1)*l)t=z+(H-1)*l;J()}function yb(b){if(!f.openLink)return false;var c=b;b=b.toLowerCase();var d=b.indexOf("http://")==0||b.indexOf("https://")==0||
b.indexOf("ftp://")==0||b.indexOf("mailto:")==0||b.indexOf("tel:")==0||b.indexOf("callto:")==0;if(!d)if(b.indexOf("www.")==0){d=true;b="http://"+b}else if(b.indexOf("ftp.")==0){d=true;b="ftp://"+b}if(d){if(b.indexOf("\r")>0||b.indexOf("\n")>0)return false;if(f.onurlredirection&&f.onurlredirection(d))return true;u.processLink(c);return true}return false}function pb(b){if(!B)return;var c=b.getData("text/plain");if(c){c=c.replace(/\r\n/g,"\n");K(false,c,3);return true}return false}function qb(){if(!O)return;
if(!aa)return;if(O.visible())return;aa.value=la;O.show();if(u)u.setIgnorePaste(false);setTimeout(function(){aa.scrollTop=aa.scrollHeight},10)}function Z(b,c){if(O)la=la+b}function rb(b){if(b==28){m.send((L?"5B":"5D")+P);P="";if(L)L=false;else{X=false;t+=l;g=p}}else if(b==14)if(P.length>0){P=P.substring(0,P.length-1);if(L){ja();W(" ");ja()}}}function K(b,c,d){if(L||X)rb(c);else m.send("8B"+d+"\t"+c);ca=c}function Ba(b,c){var d=0;var a=0;d=parseInt(b/n);a=parseInt(c/l);m.send("ED"+d+"\t"+a+"\t"+b+"\t"+
c)}if(sessionStorage)sessionStorage.clear();var aa=document.getElementById("copytextarea");var O=aa?new hi5.Lightbox(document.getElementById("copydialog")):null;var la="";this.displayMsg=true;this.reconnectTimes=0;this.openLink=true;this.setTitle=true;this.mode=0;var fa=typeof e=="object"?e:null;var xa=typeof e=="object"||e.indexOf("/PLAY?")>0;if(xa){this.mode=1;if(fa)e="";e+="&touchpad=on"}else if(e.indexOf("/JOIN?")>0){this.mode=2;this.reconnectOnResize=false}var D=hi5.appcfg||{img:{},toolbar:{fadable:true}};
var k=hi5.tool.queryToObj(e.substring(e.indexOf("?")+1));if(!k.color)k.color=32;this.server=k["server"];this.port=parseInt(k["port"],10);this.sessionInfo={major:0,minor:0,width:0,height:0,bpp:0,bigEndian:true,trueColor:true};var u=null;var B=false;var ia=false;D.copyDialog=true;var A=5;var E=0;var x=new Array;var M=0;var p=A;var z=A;var g=0;var t=0;var n=0;var l=18;var Y=0;var wa=7;var va=0;var ua=8;var G=1;var H=24;var N=null;var V=0;var C=0;var U=0;var ca=0;var ma=false;var na=false;var I=null;
window.$ssh=this;var R=new Ea(4194304);this.__que=R;this.running=function(){return B};var f=this;var m=null;if(!q)q=window.innerWidth;q-=A;k.width=q;e+="&width="+q;if(!r)r=window.innerHeight;r-=A;k.height=r;e+="&height="+r;if(!k.fontSize){if(!Q)Q=13;k.fontSize=Q;e+="&fontSize="+Q}else k.fontSize=parseInt(k.fontSize,10);var ka=["black","red","green","yellow","blue","magenta","cyan","white"];var F=oa(q,r);var h=F.getContext();var ha=new Aa;if(D.displayMsg!=undefined)this.displayMsg=D.displayMsg;if(D.reconnectTimes!=
undefined)this.reconnectTimes=D.reconnectTimes;if(D.openLink!=undefined)this.openLink=D.openLink;if(D.setTitle!=undefined)this.setTitle=D.setTitle;if(typeof D.useWSS=="boolean")e=(D.useWSS?"wss":"ws")+e.substring(e.indexOf("://"));this.getURL=function(){return e};var sb=parseInt(k.server_bpp||k.color||24);this.getColor=function(){return sb};this.setJoinMode=function(b){if(!B)return;m.send("8E1"+b)};this.refuseControl=function(b){if(!B)return;m.send("8E3"+b)};this.giveControl=function(b){if(!B)return;
m.send("8E4"+b)};this.requestControl=function(){if(!B)return;m.send("8E2")};this.play=function(){m.send("F3")};this.pause=function(){m.send("F2")};this.scan=function(b){m.send("F4"+(b?"1":"0"))};this.seek=function(b){if(u&&B){m.send("F4"+(b?"1":"0")+"\t"+(b/u.getScale()|0));F.pause(true)}};var L=false;var X=false;var P="";var ta=0;this.run=function(){Fa()};this.hide=function(){if(!u)return;if(document.getElementById("cursorID").style.display=="block")document.getElementById("cursorID").style.display=
"none";u.hide()};this.showMessage=function(b){if(!f.displayMsg||!b)return;hi5.notifications.notify({"msg":b})};this.close=function(){if(m&&B)try{m.send("85");m.close()}catch(b){}else ba()};if(!hi5.browser.isChromeApp)window.addEventListener("unload",ba,false);else chrome.runtime.onSuspend.addListener(ba);var tb=new ra(1024,function c(d){var a;for(var f=true;f;){a=d.getByte();if(a==undefined){f=false;continue}if(a==0)continue;if(a==13){ob();continue}if(a==27){a=d.getByte();if(a==77){Ua();continue}if(a==
68){Va();continue}if(a==55){Wa();continue}if(a==40){a=d.getByte();if(a==66){a=d.getByte();if(a==27){a=d.getByte();if(a==41){a=d.getByte();if(a==48)continue;else d.skipBack(1)}else d.skipBack(1)}else d.skipBack(1)}else d.skipBack(1)}if(a!="0x5b")continue;E=0;x[E]=0;for(M=0;true;){a=d.getByte();if(a==59){if(M>0){E++;x[E]=0;M=0}continue}if(48<=a&&a<=57){x[E]=x[E]*10+(a-48);M++;continue}d.skipBack(1);break}a=d.getByte();if(a==109){if(M==0&&E==0){a=d.getByte();if(a==15){T(7);S(0);continue}else{T(7);S(0);
d.skipBack(1);continue}}for(var e=0;e<=E;e++)switch(x[e]){case 0:if(E==0){T(7);S(0)}else if(e==0)T(0);else S(0);break;case 1:break;case 2:break;case 4:break;case 5:case 8:break;case 7:if(E==0){T(7);S(0)}else if(e==0)T(7);else S(7);continue;case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:T(x[e]-30);break;case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:S(x[e]-40);default:}continue}if(a==114){fb(x[0],x[1]);continue}if(a==72){if(M==0&&E==0)x[0]=x[1]=1;eb(x[0],x[1]);continue}if(a==
66){bb(x[0]);continue}if(a==68){cb(x[0]);continue}if(a==67){if(M==0&&E==0)x[0]=1;ab(x[0]);continue}if(a==65){if(M==0&&E==0)x[0]=1;db(x[0]);continue}if(a==63){a=d.getByte();if(a==49){a=d.getByte();if(a==108||a==104){a=d.getByte();if(a==27){a=d.getByte();if(a==">"||a=="=")continue}}else if(a==104){a=d.getByte();if(a==27){a=d.getByte();if(a==61)continue}}}else if(a==55){a=d.getByte();if(a==104)continue;else if(a==49)continue;d.skipBack(1);a=55}else;}if(a==75){if(M==0&&E==0)gb();else hb();continue}if(a==
74){ib();continue}continue}if(a==7)continue;if(a==9){Xa();continue}if(a==15){Ya();continue}if(a==8){ja();continue}if(a==10){Za();continue}if(a!=undefined&&a!=10){d.skipBack(1);jb(d)}if(d.getPosition()>=d.getEnd())f=false}});R.setHandler(tb);var nb=new Array;this.addSurface=function(c){u=c;if(xa)c.setPlayerMode();F.setContext(u.context);h=F.getContext();c.forceTextArea=true;c.alwaysPaste=true;c.setAutoScale(f.mode>0);c.setSize(q+A,r+A);c.setController(ha);c.setFastCopy(ea(k["fastCopy"]));c.setTouchpad(ea(k["touchpad"]));
c.setClipboard(ea(k["mapClipboard"]));c.run(99997);c.onclipdata=pb};var ub=new Uint8Array(6);ub[0]=5;var vb=new Uint8Array(8);vb[0]=4;this.writeRawInput=function(c){if(!B)return;var d=parseInt(c.substring(0,2),16);var a=c.substring(2).split("\t");var e=0;var g=false;switch(d){case 128:var h=a[2];if(h==2)qb();return;case 129:return;case 130:return;case 131:K(true,a[2]==0?200:208,0);return;case 132:g=a[0]==0;e=parseInt(a[1]);if(e==29)ma=g;if(e==56)na=g;if(a[0]==0){if(e==69)return;K(g,e,0)}else if(a[1]==
42)K(false,42,2);else if(a[1]==29)K(false,29,2);return;case 139:if(a[0]==0){if(ma&&na)return;e=parseInt(a[1]);if(L||X){if(ca==29&&e==68)f.close();return}else{if(ma&&ca!=29)K(true,29,0);if(na&&ca!=56)K(true,56,0);K(true,e,1)}}return;case 134:e=a[0].charCodeAt(0);if(L||X)mb(e);else if(e==47)K(true,191,1);else{if(e==160)a[0]=" ";K(false,a[0],3)}return}svGlobal.logger.warn("Unknowncode: "+a[1]+" type:"+d)}};
